<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Aggify Visualization</title>
    <!-- Include ECharts file from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
</head>

<body>
    <!-- Container for the ECharts visualization -->
    <div id="chart" style="width: 1100px;height:650px;"></div>
    <script type="text/javascript">
        // Based on prepared DOM, initialize echarts instance
        var myChart = echarts.init(document.getElementById('chart'));

        // Hardcoded data for the example
        var avgTimesAgg = [549.1, 2204.9, 5167.3, 4319.4, 524.0, 2819.8];
        var avgTimesBuiltin_nproc = [348.0, 919.4, 3738.8, 765.4, 756.1, 1158.6];
        var avgTimesBuiltin_nproc1 = [811.5, 2269.9, 9058.3, 4546.1, 820.7, 6001.7];
        var workLoadNames = ['OrdersByCustomer', 'PromoRevenue', 'VolumeCustomer', 'Discount Revenue', 'MinCostSupplier', 'WaitingOrders'];
        var workLoadNames_short = ['OBC', 'PR', 'VC', 'DR', 'MC', 'WO'];
        var ratios = avgTimesAgg.map(function (item, index) {
            return avgTimesBuiltin_nproc1[index] / item;
        });

        // Specify the configuration items and data for the chart
        var option = {
            title: {
                text: 'Performance Comparison of Custom vs Built-in Aggregations - Single Thread', // The title text
                left: 'center', // The position of the title
                top: 20 // The top margin of the title
            },
            legend: {
                // data: ['Custom Aggregate', 'Built-in Aggregate', 'Ratio: Custom / Built-in'],
                top: '10%', // Adjust this value as needed to position the legend below the title
                left: 'center', // Align the legend to the center, beneath the title
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'cross',
                    crossStyle: {
                        color: '#999'
                    }
                }
            },
            toolbox: {
                bottom: '1%',
                left: 'center',
                feature: {
                    dataView: { show: true, readOnly: false },
                    magicType: { show: true, type: ['line', 'bar'] },
                    restore: { show: true },
                    saveAsImage: { show: true }
                }
            },
            xAxis: [
                {
                    type: 'category',
                    data: workLoadNames,
                    axisPointer: {
                        type: 'shadow'
                    }
                }
            ],
            yAxis: [
                {
                    type: 'value',
                    name: 'Average Time (ms)',
                    min: 0,
                    axisLabel: {
                        formatter: '{value} ms'
                    }
                },
                {
                    type: 'value',
                    name: 'Speedup: Built-in / Custom',
                    min: 0,
                    axisLabel: {
                        formatter: '{value}'
                    }
                }
            ],
            series: [
                {
                    name: 'Custom Aggregate',
                    type: 'bar',
                    data: avgTimesAgg
                },
                {
                    name: 'Built-in Aggregate',
                    type: 'bar',
                    data: avgTimesBuiltin_nproc1
                },
                {
                    name: 'Speedup: Built-in / Custom',
                    type: 'line',
                    yAxisIndex: 1,
                    data: ratios
                }
            ]
        };

        // Use the specified configuration items and data to show the chart
        myChart.setOption(option);
    </script>
</body>

</html>